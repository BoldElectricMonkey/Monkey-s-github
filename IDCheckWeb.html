<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IDCheckWeb - 1.0</title>
    <link rel="icon" href="IDlogo.png" type="image/png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            padding: 20px;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 24px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }
        
        input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus {
            outline: none;
            border-color: #409eff;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        #calculateBtn {
            background-color: #409eff;
            color: white;
        }
        
        #calculateBtn:hover {
            background-color: #337ecc;
        }
        
        #verifyBtn {
            background-color: #67c23a;
            color: white;
        }
        
        #verifyBtn:hover {
            background-color: #529b2e;
        }
        
        #resetBtn {
            background-color: #909399;
            color: white;
        }
        
        #resetBtn:hover {
            background-color: #73767a;
        }
        
        .result {
            padding: 15px;
            border-radius: 6px;
            margin-top: 20px;
            display: none;
        }
        
        .success {
            background-color: #f0f9eb;
            border: 1px solid #e1f3d8;
            color: #67c23a;
        }
        
        .error {
            background-color: #fef0f0;
            border: 1px solid #fde2e2;
            color: #f56c6c;
        }
        
        .info {
            background-color: #f0f9ff;
            border: 1px solid #e6f7ff;
            color: #409eff;
        }
        
        .tips {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f8f8;
            border-radius: 6px;
            font-size: 14px;
            color: #666;
        }
        
        .tips h3 {
            font-size: 16px;
            margin-bottom: 10px;
            color: #333;
        }
        
        .tips ul {
            padding-left: 20px;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>IDCheckWeb</h1>
        
        <div class="form-group">
            <label for="idNumber">请输入身份证号码：</label>
            <input type="text" id="idNumber" placeholder="18位身份证号（最后一位可为X）或前17位数字">
        </div>
        
        <div class="btn-group">
            <button id="calculateBtn">计算校验码</button>
            <button id="verifyBtn">验证完整身份证号</button>
            <button id="resetBtn">重置</button>
        </div>
        
        <div id="resultDisplay" class="result"></div>
        
        <div class="tips">
            <h3>使用说明</h3>
            <ul>
                <li>输入18位完整身份证号，可验证最后一位校验码是否正确</li>
                <li>仅输入前17位数字，可计算出正确的第18位校验码</li>
                <h3> </h3>
            </ul>
            <h3>温馨提示</h3>
            <ul>
                <li>本工具仅用于校验码验证，不存储任何身份证信息</li>
                <li>本工具“验证完整身份证号”正在测试中，现仅准确计算校验码和检验校验码与前17位的关系的准确性，身份证检验的前17位的准确性不计入</li>
            </ul>
        </div>
    </div>

    <script>
        // 获取DOM元素
        const idNumberInput = document.getElementById('idNumber');
        const calculateBtn = document.getElementById('calculateBtn');
        const verifyBtn = document.getElementById('verifyBtn');
        const resetBtn = document.getElementById('resetBtn');
        const resultDisplay = document.getElementById('resultDisplay');

        // 身份证校验码计算核心函数
        function calculateCheckCode(front17) {
            // 加权因子
            const factors = [7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2];
            // 校验码对应值
            const checkCodes = ['1', '0', 'X', '9', '8', '7', '6', '5', '4', '3', '2'];
            
            let sum = 0;
            for (let i = 0; i < 17; i++) {
                sum += parseInt(front17.charAt(i)) * factors[i];
            }
            
            const mod = sum % 11;
            return checkCodes[mod];
        }

        // 显示结果
        function showResult(message, type) {
            resultDisplay.textContent = message;
            resultDisplay.className = `result ${type}`;
            resultDisplay.style.display = 'block';
        }

        // 验证输入合法性
        function validateInput(input) {
            // 18位身份证号（最后一位可以是X）
            const reg18 = /^[1-9]\d{16}[\dX]$/i;
            // 17位数字（用于计算校验码）
            const reg17 = /^[1-9]\d{16}$/;
            
            if (input.length === 18) {
                return reg18.test(input) ? '18' : false;
            } else if (input.length === 17) {
                return reg17.test(input) ? '17' : false;
            } else {
                return false;
            }
        }

        // 计算校验码按钮点击事件
        calculateBtn.addEventListener('click', function() {
            const input = idNumberInput.value.trim().toUpperCase();
            const validateResult = validateInput(input);
            
            if (!validateResult) {
                showResult('输入错误！请输入17位数字或18位完整身份证号', 'error');
                return;
            }
            
            // 如果输入18位，提取前17位计算
            const front17 = validateResult === '18' ? input.substring(0, 17) : input;
            const checkCode = calculateCheckCode(front17);
            
            if (validateResult === '18') {
                const inputCheckCode = input.charAt(17).toUpperCase();
                if (inputCheckCode === checkCode) {
                    showResult(`计算结果：正确的校验码是${checkCode}，您输入的身份证号校验码正确！`, 'success');
                } else {
                    showResult(`计算结果：正确的校验码是${checkCode}，您输入的身份证号校验码错误（您输入的是${inputCheckCode}）！`, 'error');
                }
            } else {
                showResult(`计算结果：前17位数字"${front17}"对应的校验码是${checkCode}，完整身份证号应为${front17}${checkCode}`, 'info');
            }
        });

        // 验证完整身份证号按钮点击事件
        verifyBtn.addEventListener('click', function() {
            const input = idNumberInput.value.trim().toUpperCase();
            const validateResult = validateInput(input);
            
            if (validateResult !== '18') {
                showResult('验证失败！请输入完整的18位身份证号', 'error');
                return;
            }
            
            const front17 = input.substring(0, 17);
            const checkCode = calculateCheckCode(front17);
            const inputCheckCode = input.charAt(17).toUpperCase();
            
            if (inputCheckCode === checkCode) {
                showResult(`验证成功！您输入的身份证号${input}校验码正确`, 'success');
            } else {
                showResult(`验证失败！您输入的身份证号校验码错误，正确的校验码应为${checkCode}`, 'error');
            }
        });

        // 重置按钮点击事件
        resetBtn.addEventListener('click', function() {
            idNumberInput.value = '';
            resultDisplay.style.display = 'none';
            idNumberInput.focus();
        });

        // 输入框回车事件
        idNumberInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                calculateBtn.click();
            }
        });

        // 页面加载时聚焦输入框
        window.addEventListener('load', function() {
            idNumberInput.focus();
        });
    </script>
</body>
</html>
